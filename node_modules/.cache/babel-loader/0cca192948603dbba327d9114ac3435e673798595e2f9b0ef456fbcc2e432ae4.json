{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Luis Escorcia T-blue\\\\Pictures\\\\chat-app\\\\chat-app\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useEffect, useState } from 'react';\nimport { supabase } from '../utils/supabaseClient';\n\n// Creación del contexto de autenticación para ser usado en toda la aplicación.\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext({});\n\n/**\n * Proveedor de Autenticación: Maneja el estado global del usuario y su perfil.\n */\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [user, setUser] = useState(null); // Datos de la cuenta de auth\n  const [profile, setProfile] = useState(null); // Metadatos adicionales desde la tabla 'profiles'\n  const [loading, setLoading] = useState(true); // Estado de carga inicial\n\n  useEffect(() => {\n    // 1. Obtener la sesión inicial al cargar la aplicación.\n    supabase.auth.getSession().then(({\n      data: {\n        session\n      }\n    }) => {\n      var _session$user;\n      setUser((_session$user = session === null || session === void 0 ? void 0 : session.user) !== null && _session$user !== void 0 ? _session$user : null);\n      if (session !== null && session !== void 0 && session.user) fetchProfile(session.user.id);else setLoading(false);\n    });\n\n    // 2. Suscribirse a cambios en el estado de autenticación (Login, Logout, Token renovado).\n    const {\n      data: {\n        subscription\n      }\n    } = supabase.auth.onAuthStateChange((_event, session) => {\n      var _session$user2;\n      setUser((_session$user2 = session === null || session === void 0 ? void 0 : session.user) !== null && _session$user2 !== void 0 ? _session$user2 : null);\n      if (session !== null && session !== void 0 && session.user) fetchProfile(session.user.id);else {\n        setProfile(null);\n        setLoading(false);\n      }\n    });\n\n    // Limpieza de la suscripción al desmontar el componente.\n    return () => subscription.unsubscribe();\n  }, []);\n\n  /**\n   * Obtiene la información del perfil del usuario desde la base de datos.\n   */\n  async function fetchProfile(userId) {\n    const {\n      data\n    } = await supabase.from('profiles').select('*').eq('id', userId).single();\n    setProfile(data);\n    setLoading(false);\n  }\n\n  /**\n   * Registra un nuevo usuario con metadatos (username, nombre para mostrar).\n   */\n  async function signUp(email, password, username, displayName) {\n    const {\n      data,\n      error\n    } = await supabase.auth.signUp({\n      email,\n      password,\n      options: {\n        data: {\n          username,\n          display_name: displayName\n        }\n      }\n    });\n    return {\n      data,\n      error\n    };\n  }\n\n  /**\n   * Inicia sesión con correo y contraseña.\n   */\n  async function signIn(email, password) {\n    const {\n      data,\n      error\n    } = await supabase.auth.signInWithPassword({\n      email,\n      password\n    });\n    return {\n      data,\n      error\n    };\n  }\n\n  /**\n   * Cierra la sesión del usuario actual.\n   */\n  async function signOut() {\n    await supabase.auth.signOut();\n  }\n\n  /**\n   * Actualiza los datos del perfil del usuario (ej: bio, nombre para mostrar).\n   */\n  async function updateProfile(updates) {\n    const {\n      data,\n      error\n    } = await supabase.from('profiles').update(updates).eq('id', user.id).select().single();\n    if (!error) setProfile(data);\n    return {\n      data,\n      error\n    };\n  }\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      profile,\n      loading,\n      signUp,\n      signIn,\n      signOut,\n      updateProfile,\n      fetchProfile: () => fetchProfile(user === null || user === void 0 ? void 0 : user.id)\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 5\n  }, this);\n}\n\n// Hook personalizado para acceder fácilmente al contexto de autenticación.\n_s(AuthProvider, \"DYSpA4ZauWKW8e4CNkO4ayA+RbM=\");\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","supabase","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","user","setUser","profile","setProfile","loading","setLoading","auth","getSession","then","data","session","_session$user","fetchProfile","id","subscription","onAuthStateChange","_event","_session$user2","unsubscribe","userId","from","select","eq","single","signUp","email","password","username","displayName","error","options","display_name","signIn","signInWithPassword","signOut","updateProfile","updates","update","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","$RefreshReg$"],"sources":["C:/Users/Luis Escorcia T-blue/Pictures/chat-app/chat-app/src/context/AuthContext.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from 'react'\nimport { supabase } from '../utils/supabaseClient'\n\n// Creación del contexto de autenticación para ser usado en toda la aplicación.\nconst AuthContext = createContext({})\n\n/**\n * Proveedor de Autenticación: Maneja el estado global del usuario y su perfil.\n */\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState(null)          // Datos de la cuenta de auth\n  const [profile, setProfile] = useState(null)    // Metadatos adicionales desde la tabla 'profiles'\n  const [loading, setLoading] = useState(true)    // Estado de carga inicial\n\n  useEffect(() => {\n    // 1. Obtener la sesión inicial al cargar la aplicación.\n    supabase.auth.getSession().then(({ data: { session } }) => {\n      setUser(session?.user ?? null)\n      if (session?.user) fetchProfile(session.user.id)\n      else setLoading(false)\n    })\n\n    // 2. Suscribirse a cambios en el estado de autenticación (Login, Logout, Token renovado).\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {\n      setUser(session?.user ?? null)\n      if (session?.user) fetchProfile(session.user.id)\n      else {\n        setProfile(null)\n        setLoading(false)\n      }\n    })\n\n    // Limpieza de la suscripción al desmontar el componente.\n    return () => subscription.unsubscribe()\n  }, [])\n\n  /**\n   * Obtiene la información del perfil del usuario desde la base de datos.\n   */\n  async function fetchProfile(userId) {\n    const { data } = await supabase\n      .from('profiles')\n      .select('*')\n      .eq('id', userId)\n      .single()\n    setProfile(data)\n    setLoading(false)\n  }\n\n  /**\n   * Registra un nuevo usuario con metadatos (username, nombre para mostrar).\n   */\n  async function signUp(email, password, username, displayName) {\n    const { data, error } = await supabase.auth.signUp({\n      email,\n      password,\n      options: {\n        data: { username, display_name: displayName }\n      }\n    })\n    return { data, error }\n  }\n\n  /**\n   * Inicia sesión con correo y contraseña.\n   */\n  async function signIn(email, password) {\n    const { data, error } = await supabase.auth.signInWithPassword({ email, password })\n    return { data, error }\n  }\n\n  /**\n   * Cierra la sesión del usuario actual.\n   */\n  async function signOut() {\n    await supabase.auth.signOut()\n  }\n\n  /**\n   * Actualiza los datos del perfil del usuario (ej: bio, nombre para mostrar).\n   */\n  async function updateProfile(updates) {\n    const { data, error } = await supabase\n      .from('profiles')\n      .update(updates)\n      .eq('id', user.id)\n      .select()\n      .single()\n    if (!error) setProfile(data)\n    return { data, error }\n  }\n\n  return (\n    <AuthContext.Provider value={{\n      user, profile, loading, signUp, signIn, signOut, updateProfile,\n      fetchProfile: () => fetchProfile(user?.id)\n    }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\n// Hook personalizado para acceder fácilmente al contexto de autenticación.\nexport const useAuth = () => useContext(AuthContext)\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}